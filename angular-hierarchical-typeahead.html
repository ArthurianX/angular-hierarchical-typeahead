<div class="art-typeahead-container">
    <div class="art-search">
        <div class="levels"
             ng-repeat="level in levelsActive track by $index"
             ng-if="level.isVisible"
             ng-class="{active: level.isActive}"
             ng-click="actionLevel(level, $index)"
             style="background-color: {{level.bColor}}; border-color: {{level.bColor}}"
        >
            <i style="color: {{level.color}}" class="{{level.icon}}" aria-hidden="true"></i> {{level.activeName || level.name}}
        </div>
        <span class="text-clone"></span>
        <input ng-style="hideInput(lastLevel)" type="text" ng-model="query" ng-model-options="{ debounce: 500 }" class="levels search-bar" placeholder="{{translations.SEARCH_FOR}} {{currentPlaceholder}}" autofocus>
    </div>
    <div class="art-loader" ng-if="loading">
        <svg class="art-circular" viewBox="25 25 50 50">
            <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/>
        </svg>
    </div>
    <div class="art-results" ng-class="{'art-loading': loading}">
        <ul kb-list ng-if="results">

            <li ng-if="!allData || !mappings" ng-repeat="item in results track by $index" kb-item kb-invoke="selectItem(item, $index, $event)" data-has-index="{{$index}}" ng-keydown="focusOnSearch($event)">
                {{item.name}}
            </li>

            <!-- Map all the existing properties into display if there's no mapping object for this level-->
            <li class="art-no-height" ng-if="allData">
                <table class="table">
                    <thead>
                        <tr>
                            <th ng-if="!mappings[activeLevel]" ng-repeat="(key, value) in results[0]">{{key}}</th>
                            <th ng-if="mappings && mappings[activeLevel]" ng-repeat="heading in mappings[activeLevel]">
                                {{heading.name}}
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="item in results track by $index" kb-item kb-invoke="selectItem(item, $index, $event)" data-has-index="{{$index}}" ng-keydown="focusOnSearch($event)">
                            <td ng-repeat="(key, value) in item" ng-if="key != 'id'">
                                <span ng-if="!item[key].hasCallback">{{item[key]}}</span>
                                <span ng-if="item[key].hasCallback">
                                    <button ng-click="item[key].callback(item)">{{item[key].action}}</button>
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>

            <li ng-if="pagination" class="load-more" ng-click="getOutsideData(false, true)">
                <i class="fa fa-plus" aria-hidden="true"></i> {{translations.LOAD_MORE}}
            </li>
        </ul>
        <ul>
            <li ng-if="!results && !loading && !tooMany">
                <i class="fa fa-ban" aria-hidden="true"></i> {{translations.NO_RESULTS}}
            </li>

            <li ng-if="!results && !loading && tooMany">
                <i class="fa fa-ban" aria-hidden="true"></i> {{translations.TOO_MANY_RESULTS}}
            </li>
        </ul>
    </div>
    <div class="art-elements-added" ng-if="pagination && addedElements"> <!--&& addedElements-->
        <i class="fa fa-plus" aria-hidden="true"></i>{{elementsAdded}}
    </div>

    <div style="text-align: right; clear: both" class="art-tooltip-helper" ng-click="showTooltip = !showTooltip">
        <i class="fa fa-question-circle" aria-hidden="true"></i>
        <small ng-if="results && showTooltip" class="art-tooltip">

            <table class="table table-bordered" style="width: 50%; float: right">
                <thead>
                <tr>
                    <th>{{translations.HELP_ACTION}}</th>
                    <th>{{translations.HELP_DESCRIPTION}}</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><i class="fa fa-arrow-down" aria-hidden="true"></i> & <i class="fa fa-arrow-up" aria-hidden="true"></i></td>
                    <td valign="middle">{{translations.HELP_ARROWS_TEXT}}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-mouse-pointer" aria-hidden="true"></i> {{translations.HELP_CLICK}}</td>
                    <td rowspan="2" valign="middle">{{translations.HELP_LOAD}} {{currentPlaceholder}} {{translations.HELP_VIEW}}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-keyboard-o" aria-hidden="true"></i> {{translations.HELP_SPACE}}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-mouse-pointer" aria-hidden="true"></i> + <i class="fa fa-mouse-pointer" aria-hidden="true"></i> {{translations.HELP_DOUBLE_CLICK}}</td>
                    <td rowspan="2" valign="middle">{{translations.HELP_OPEN}} {{currentPlaceholder}} {{translations.HELP_LEVEL}}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-keyboard-o" aria-hidden="true"></i> {{translations.HELP_ENTER}}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-keyboard-o" aria-hidden="true"></i> {{translations.HELP_BACKSPACE}}</td>
                    <td valign="middle">{{translations.HELP_GO_BACK}}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-mouse-pointer" aria-hidden="true"></i> {{translations.HELP_CLICK}} {{translations.HELP_LEVEL2}}</td>
                    <td valign="middle">{{translations.HELP_GO_BACK_CLICKED}}</td>
                </tr>
                <tr>
                    <td><i class="fa fa-keyboard-o" aria-hidden="true"></i> {{translations.HELP_ANY_KEY}}</td>
                    <td valign="middle">{{translations.HELP_ANY_KEY_PART1}} {{currentPlaceholder}} {{translations.HELP_ANY_KEY_PART2}}</td>
                </tr>
                </tbody>
            </table>
        </small>
    </div>



</div>